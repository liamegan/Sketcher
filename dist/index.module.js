import{SVG as t}from"@svgdotjs/svg.js";import{Vec2 as i}from"wtc-math";var e=0;function s(t){return"__private_"+e+++"_"+t}function r(t,i){if(!Object.prototype.hasOwnProperty.call(t,i))throw new TypeError("attempted to use private field on non-instance");return t}var o=s("drawing"),n=s("ctx"),h=s("mode"),a=s("instructions"),c=s("dimensions"),l=s("pxratio"),d=s("stroke"),f=s("fill"),u=s("saving"),g=function(){function e(i,s){void 0===i&&(i=e.DT_CANVAS),Object.defineProperty(this,o,{writable:!0,value:void 0}),Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:[]}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:1}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:null}),Object.defineProperty(this,u,{writable:!0,value:!1}),s=Object.assign({},e.defaults,s),this.mode=i,this.mode&e.DT_CANVAS?r(this,o)[o]=document.createElement("canvas"):this.mode&e.DT_SVG&&(r(this,o)[o]=t()),this.stroke=s.stroke,this.pxratio=s.pxratio}var s,g=e.prototype;return g.clear=function(){var t;this.mode&e.DT_CANVAS?(t=this.c).clearRect.apply(t,[0,0].concat(this.dimensions.scaleNew(this.pxratio).array)):this.mode&e.DT_SVG&&this.drawing.clear()},g.rect=function(t,i){var s;if(this.saving&&r(this,a)[a].push({f:"rect",args:[t,i]}),t=t.scaleNew(this.pxratio),i=i.scaleNew(this.pxratio),this.mode&e.DT_CANVAS)this.c.beginPath(),(s=this.c).rect.apply(s,t.array.concat(i.array)),this.c.stroke();else if(this.mode&e.DT_SVG){var o;(o=this.drawing.rect(i.width,i.height)).move.apply(o,t.array).fill(this.svgFill).stroke("#f06")}},g.circle=function(t,i){if(this.saving&&r(this,a)[a].push({f:"circle",args:[t,i]}),t=t.scaleNew(this.pxratio),i*=this.pxratio,this.mode&e.DT_CANVAS)this.fill&&(this.c.fillStyle=this.fill),this.c.beginPath(),this.c.arc(t.x,t.y,i,0,2*Math.PI),this.stroke&&this.c.stroke(),this.fill&&this.c.fill();else if(this.mode&e.DT_SVG){var s;(s=this.drawing.circle(2*i).fill(this.svgFill).stroke(this.svgStroke)).move.apply(s,t.subtractScalarNew(i).array)}},g.line=function(t,i){if(this.saving&&r(this,a)[a].push({f:"line",args:[t,i]}),t=t.scaleNew(this.pxratio),i=i.scaleNew(this.pxratio),this.mode&e.DT_CANVAS)this.c.beginPath(),this.c.moveTo(t.x,t.y),this.c.lineTo(i.x,i.y),this.stroke&&this.c.stroke();else if(this.mode&e.DT_SVG){var s;(s=this.drawing).line.apply(s,t.array.concat(i.array)).stroke(this.svgStroke)}},g.polyline=function(t){var i=this;this.saving&&r(this,a)[a].push({f:"polyline",args:t}),this.mode&e.DT_CANVAS?(this.c.beginPath(),t.forEach(function(t,e){t=t.scaleNew(i.pxratio),0===e?i.c.moveTo(t.x,t.y):i.c.lineTo(t.x,t.y)}),this.stroke&&this.c.stroke()):this.mode&e.DT_SVG&&this.drawing.polyline(t.map(function(t){return t.array})).fill(this.svgFill).stroke(this.svgStroke)},g.path=function(t){if(this.mode&e.DT_CANVAS){this.c.beginPath();var i=new Path2D(t),s=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),r=new Path2D,o=s.scale(this.pxratio);r.addPath(i,o),this.stroke&&this.c.stroke(r)}else this.mode&e.DT_SVG&&this.drawing.path(t).fill(this.svgFill).stroke(this.svgStroke)},g.polygon=function(t){var i=this;this.saving&&r(this,a)[a].push({f:"polygon",args:[t]}),this.mode&e.DT_CANVAS?(this.c.beginPath(),t.forEach(function(t,e){t=t.scaleNew(i.pxratio),0===e?i.c.moveTo(t.x,t.y):i.c.lineTo(t.x,t.y)}),this.stroke&&this.c.stroke(),this.fill&&this.c.fill()):this.mode&e.DT_SVG&&this.drawing.polygon(t.map(function(t){return t.array})).fill(this.svgFill).stroke(this.svgStroke)},g.download=function(){var t;this.mode&e.DT_CANVAS?(t=new e(e.DT_SVG,{}).size(this.dimensions),r(this,a)[a].forEach(function(i){var e;(e=t)[i.f].apply(e,i.args)})):this.mode&e.DT_SVG&&(t=this);var i="data:image/svg+xml;utf8,"+encodeURIComponent(t.drawing.svg()),s=document.createElement("a");s.download="untitled.svg",s.href=i,s.click()},g.addTo=function(t){return"string"==typeof t&&(this.mode&e.DT_CANVAS?document.body.querySelector(t).appendChild(this.drawing):this.mode&e.DT_SVG&&this.drawing.addTo("#container")),this},g.size=function(t){if(this.mode&e.DT_CANVAS)this.drawing.width=t.width*r(this,l)[l],this.drawing.height=t.height*r(this,l)[l];else if(this.mode&e.DT_SVG){var i;(i=this.drawing).size.apply(i,t.scaleNew(r(this,l)[l]).array),r(this,o)[o].viewbox("0 0 "+t.x*r(this,l)[l]+" "+t.y*r(this,l)[l])}return r(this,c)[c]=t,this},(s=[{key:"dimensions",get:function(){return r(this,c)[c]},set:function(t){t instanceof i&&(r(this,c)[c]=t,this.size(t))}},{key:"pxratio",get:function(){return r(this,l)[l]||1},set:function(t){t>0&&(r(this,l)[l]=t)}},{key:"drawing",get:function(){return r(this,o)[o]}},{key:"c",get:function(){if(this.mode&e.DT_CANVAS)return r(this,n)[n]||(r(this,n)[n]=this.drawing.getContext("2d")),r(this,n)[n]}},{key:"stroke",get:function(){return r(this,d)[d]},set:function(t){r(this,d)[d]=t,this.mode&e.DT_CANVAS&&(this.c.strokeStyle=t)}},{key:"svgStroke",get:function(){return r(this,d)[d]?r(this,d)[d]:{}}},{key:"fill",get:function(){return r(this,f)[f]},set:function(t){r(this,f)[f]=t,this.mode&e.DT_CANVAS&&(this.c.fillStyle=t)}},{key:"svgFill",get:function(){return r(this,f)[f]?r(this,f)[f]:"none"}},{key:"mode",get:function(){return r(this,h)[h]||e.DT_CANVAS},set:function(t){t&(e.DT_CANVAS|e.DT_SVG)&&(r(this,h)[h]=t)}},{key:"saving",get:function(){return r(this,u)[u]},set:function(t){r(this,u)[u]=!0===t}}])&&function(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}(e.prototype,s),e}();g.defaults={stroke:"#333",pxratio:1},g.DT_CANVAS=1,g.DT_SVG=2;export{g as default};
//# sourceMappingURL=index.module.js.map
